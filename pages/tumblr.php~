<?php
$page->meta['title'] = "Home";
$page->meta['css'] = "tumblr.css";

$page->find_gets();

if(isset($page->gets['num'])) {
	$num = $page->gets['num'];
} else {
	$num = "5";
}

if(isset($page->gets['start'])) {
	$start = $page->gets['start'];
} else {
	$start = "0";
}

$xml = simplexml_load_file("http://asmallorange.tumblr.com/api/read?num=$num&start=$start");

foreach ($xml->posts->post as $post) :
	echo '<div class="post '.$post->attributes()->type.'">';
	switch ($post->attributes()->type) :
	
		case "photo" :	
			foreach ($post->{'photo-url'} as $photo)
				if ($photo->attributes()->{'max-width'} == "500")
					echo '<img src="'.$photo.'" alt="" />';				
			echo $post->{'photo-caption'}.'<hr>';
			break;
			
		case "quote":
			echo '<i class="quote">'.$post->{'quote-text'}.'</i>';
			if(isset($post->{'quote-source'}))
				echo '<div class="quote-source">'.$post->{'quote-source'}.'</div>';
			echo '<hr>';
			break;
			
		case "regular":
			echo $post->{'regular-body'}.'<hr>';
			break;
			
	endswitch;
	echo "</div>";
endforeach;

?>

<div class="last">
	See more on my <a href="http://asmallorange.tumblr.com">tumblr</a>.
	<?php
		$next = '<a href="http://borntyping.co.uk/?start='.($num+$start);
		if(isset($page->gets['num']))
			$next .= '&num='.$num;
		$next .= '">Next</a>';
		echo '<div id="next">'.$next.'</div>';
	?>
</div>